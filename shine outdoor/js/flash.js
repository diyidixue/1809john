__mjsload("flash",'\'use strict\';function d(e,d){this._genId();for(var g in d)d.hasOwnProperty(g)&&(this[g]=d[g]);this.flashVars={callback:this._getKey("swfCallbackId")};this.status=0;this.waitQuene=[];this.view=e;this._isFirstChange=this._isFristLoadFlash=!0;this._labels={};this._labelsArr=[];this._plugins={};this._bindSwfCallback();this.createPano();this._initEvents();this.view._render=this}function h(e){return document.getElementById(e)}function l(e){return"[object Number]"==Object.prototype.toString.call(e)&&isFinite(e)}function m(e,d){e=Math.round(10*e)/10;d=Math.round(10*d)/10;return e==d}function n(e){e=Math.log(Math.tan(.008726646259971648*(90+e)))/.017453292519943295;return e*J}function w(e){e/=J;return 114.59155902616465*Math.atan(Math.exp(.017453292519943295*e))-90}function H(e){var d=[],g;for(g in e)e.hasOwnProperty(g)&&d.push(g+"="+encodeURIComponent(e[g]));return d.join("&")}function S(){var e=navigator.userAgent;return/gecko/i.test(e)&&!/like gecko/i.test(e)}function O(){return/msie (\\d+\\.\\d+)/i.test(navigator.userAgent)?document.documentMode||+RegExp.$1:0}function R(e,d){e=e.split(".");d=d.split(".");for(var g=Math.max(e.length,d.length),h=0;h<g;h++){var l=e[h],m=d[h];if(!l||!m)return l||m?l?1:-1:0;l=Number(l);m=Number(m);if(l<m)return-1;if(l>m)return 1}return 0}function r(e){var d=O()?\' classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0"\':\' type="application/x-shockwave-flash"\',g=["id","width","height","align","data"],h="wmode movie flashvars scale quality play loop menu salign bgcolor base allowscriptaccess allownetworking allowfullscreen seamlesstabbing devicefont swliveconnect".split(" ");e=e||{};a:{var l;l=e.minVer;var m=e.maxVer;if(l||m){var n,r=O();if(null==n){var u=navigator;if(u.plugins&&u.mimeTypes.length)(r=u.plugins["Shockwave Flash"])&&r.description&&(n=r.description.replace(/([a-zA-Z]|\\s)+/,"").replace(/(\\s)+r/,".")+".0");else if(r)try{var w=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");w&&(n=w.GetVariable("$version").replace(/WIN/g,"").replace(/,/g,"."))}catch(A){}}if(!n||l&&0>R(n,l)||m&&0<R(n,m)){e=e.altHtml||"";break a}}m=["<object",d];e.data=e.movie;for(d=0;d<g.length;d++)l=g[d],e.hasOwnProperty(l)&&m.push(" ",l,\'="\',e[l],\'"\');m.push(">");for(d=0;d<h.length;d++)l=h[d],e.hasOwnProperty(l)&&m.push(\'<param name="\',l,\'" value="\',e[l],\'"/>\');m.push("</object>");e=m.join("")}return e}var u=pa,Q=/(\\d+\\.\\d)?(?:\\.\\d)?\\s+safari\\/?(\\d+\\.\\d+)?/i.test(u)&&!/chrome/i.test(u)?+(RegExp.$1||RegExp.$2):0,U={movie:"http://s.map.qq.com/TPano/TPanoFlash/v1.4.0/core/TPano.swf",altHtml:\'<div style="position: relative;width: 300px;background-color:#FFEFB6;border: 1px solid #FFC337;margin: 65px auto;padding: 10px;"><p>\\u4f7f\\u7528\\u817e\\u8baf\\u8857\\u666f\\uff0c\\u9700\\u8981\\u5c06\\u60a8\\u7684Adobe Flash Player \\u64ad\\u653e\\u5668\\u5347\\u7ea7\\u523010\\u6216\\u66f4\\u65b0\\u7248\\u672c</p><div><a href="http://get.adobe.com/cn/flashplayer/" target="_blank;">\\u4e0b\\u8f7d\\u6700\\u65b0\\u7248\\u672c</a></div></div>\',minVer:"10.0.0",width:"100%",height:"100%",bgcolor:"#EEEEEE",wmode:"transparent",align:"middle",quality:"high",allowscriptaccess:"always",allowfullscreen:"true",menu:!1},J=111319.49077777778,K=0;window.checkJSReady=function(){return!0};u=d.prototype;u._setKey=function(e,d){var g=this[e];g&&g==d||(this[e]=d)};u._getKey=function(e){return this[e]};u.createPano=function(){var e=this.flashVars;e.panoId=this._getKey("pano");var d=this._getKey("pov");d&&(null!==d.heading&&(e.heading=d.heading),null!==d.pitch&&(e.pitch=d.pitch));null!==this._getKey("zoom")&&(e.zoom=parseInt(this._getKey("zoom")));this._getKey("disableMove")&&(e.disableMove=this._getKey("disableMove"));this._getKey("pf")&&(e.pf=this._getKey("pf"));this._getKey("ch")&&(e.ch=this._getKey("ch"));this._getKey("key")&&(e.key=this._getKey("key"));e.keystatus=1;d=[];U.id=this._getKey("swfId");U.flashvars=H(e);e=r(U);d.push(e);e=document.createElement("div");e.style.width="100%";e.style.height="100%";!1===this._getKey("visible")&&(e.style.visibility="hidden");e.innerHTML=d.join("");this._setKey("panoContainer",e);d=this._getKey("container");("object"==typeof d?d:document.getElementById(d)).appendChild(e);this.status=1;if(-1==window.location.href.indexOf("http://")){var g=this;setTimeout(function(){g.checkCommunication()},3e3)}};u.setKeyStatus=function(e){this._sendToAs("setKeyStatus",e)};u.removePano=function(){this.status=0;this.waitQuene=[];this._isFristLoadFlash=!0;var e=h(this._getKey("swfId"));if(e){var d=O();if(e&&d){e.style.display="none";for(var g in e)"function"===typeof e[g]&&(e[g]=null);window.CollectGarbage&&setTimeout(window.CollectGarbage,0)}d=document.createElement("div");d.appendChild(e);d.innerHTML="";e=this._getKey("container");("object"==typeof e?e:document.getElementById(e)).removeChild(this._getKey("panoContainer"))}};u.setVisible=function(e){this._getKey("visible")!=e&&(this._setKey("visible",e),this._getKey("panoContainer").style.visibility=e?"visible":"hidden")};u.setPano=function(e){if(!e)this._setKey("pano",null);else if(e&&e!==this._getKey("pano")){this._getKey("pano")||(this._setKey("pano",e),this.removePano(),this.createPano(),this._initEvents());var d={svid:e};this._setKey("_setPanoValue",{svid:e});this._sendToAs("setPanoOptions",d)}};u.setThumb=function(e){this._sendToAs("setThumb",e.globe)};u.setPov=function(e){var d=this._getKey("pov"),g={},h=!1;!e||!l(e.heading)||d&&d.heading===e.heading||(g.heading=Math.round(10*e.heading)/10,h=!0);!e||!l(e.pitch)||d&&d.pitch===e.pitch||(g.pitch=Math.round(10*e.pitch)/10,h=!0);h&&(this._setKey("_setPovValue",g),this._sendToAs("setPanoOptions",g))};u.setZoom=function(e){var d=this._getKey("zoom");parseInt(e)!=d&&(d={zoom:parseInt(e)},this._setKey("_setZoomValue",parseInt(e)),this._sendToAs("setPanoOptions",d))};u.pano_changed=function(e){var d=this._getKey("pano");if(d&&d!=e||this._isFirstChange)this._setKey("pano",e),this._setKey("_setPanoValue",e),this.view.fireEvent("pano_changed",e,this.view)};u.pov_changed=function(e){var d=this._getKey("pov")||{};this._pov=e;var g=0,h={};d&&(h.heading=d.heading,h.pitch=d.pitch);d&&m(e.heading,d.heading)||(h.heading=e.heading,g=1);d&&m(e.pitch,d.pitch)||(h.pitch=e.pitch,g=1);if(g||this._isFirstChange)this._setKey("pov",h),this._setKey("_setPovValue",h),this.view.fireEvent("pov_changed",h,this.view)};u.zoom_changed=function(e){if(e!==this._getKey("zoom")||this._isFirstChange)this._setKey("zoom",e),this._setKey("_setZoomValue",e),this.view.fireEvent("zoom_changed",e,this.view)};u.addLabel=function(e){this._labels[e.id]||(this._labelsArr.push(e),this._labels[e.id]=e,this._sendToAs("addLabel",{id:e.id,lat:n(e.position.lat),lng:e.position.lng*J,height:e.altitude,content:e.content}))};u.removeLabel=function(e){this._sendToAs("removeLabel",{id:e});this._labels[e]=void 0;for(var d=0;d<this._labelsArr.length;d++)this._labelsArr[d].id==e&&this._labelsArr.splice(d,1)};u.addPlugin=function(e){this._sendToAs("addPlugin",{name:e.id,options:{url:"http://s.map.qq.com/TPano/TPanoFlash/v1.4.0/plugins/"+e.name}});this._plugins[e.id]||(this._plugins[e.id]=e)};u.autoPlayStart=function(e){this._sendToAs("autoPlayStart",e)};u.autoPlayStop=function(){this._sendToAs("autoPlayStop")};u._onInterfaceReady=function(){for(this.status=2;0<this.waitQuene.length;){var e=this.waitQuene.shift();this._sendToAs(e.eventName,e.data,e.tp)}};u._addDefalutPlugin=function(){(!this._getKey("disableMove")||!0!==this._getKey("disableMove")&&1!==this._getKey("disableMove"))&&this._sendToAs("addPlugin",{name:"PanoOverlay",options:{url:"http://s.map.qq.com/TPano/TPanoFlash/v1.4.0/plugins/PanoOverlay.swf"}});(!this._getKey("disableCompass")||!0!==this._getKey("disableCompass")&&1!==this._getKey("disableCompass"))&&this._sendToAs("addPlugin",{name:"1",options:{url:"http://s.map.qq.com/TPano/TPanoFlash/v1.4.0/plugins/PanoCompass.swf"}});(!this._getKey("disableLogo")||!0!==this._getKey("disableLogo")&&1!==this._getKey("disableLogo"))&&this._sendToAs("addPlugin",{name:"2",options:{url:"http://s.map.qq.com/TPano/TPanoFlash/v1.4.0/plugins/PanoLogo.swf"}});(!this._getKey("disableFullScreen")||!0!==this._getKey("disableFullScreen")&&1!==this._getKey("disableFullScreen"))&&this._sendToAs("addPlugin",{name:"3",options:{url:"http://s.map.qq.com/TPano/TPanoFlash/v1.4.0/plugins/PanoFullScreen.swf"}})};u._addResetFlash=function(){var e={};this._getKey("_setPovValue")&&(e.heading=this._getKey("_setPovValue").heading,e.pitch=this._getKey("_setPovValue").pitch,this._sendToAs("setPanoOptions",e));this._getKey("_setZoomValue")&&this._sendToAs("setPanoOptions",{zoom:parseInt(this._getKey("_setZoomValue"))});for(e=0;e<this._labelsArr.length;e++){var d=this._labelsArr[e];this._sendToAs("addLabel",{id:d.id,lat:n(d.position.lat),lng:d.position.lng*J,height:d.altitude,content:d.content})}};u._sendToAs=function(e,d,g){if(2<=this.status)try{h(this._getKey("swfId"))[g?"sendToPlugin":"sendToAS"](e,d)}catch(l){}else d=qa({},d),this.waitQuene.push({eventName:e,data:d,tp:g})};u._sendToPlugin=function(e,d){this._sendToAs(e,d,!0)};u.checkCommunication=function(){try{h(this._getKey("swfId")).callBackToAS("checkCommunication")}catch(e){var d=this._getKey("panoContainer"),g=document.createElement("div");g.innerHTML="API\\u7a0b\\u5e8f\\u65e0\\u6cd5\\u4e0eflash\\u901a\\u4fe1\\uff0c\\u5bfc\\u81f4\\u8857\\u666f\\u53ef\\u80fd\\u65e0\\u6cd5\\u6b63\\u5e38\\u4f7f\\u7528\\uff0c\\u8fd9\\u53ef\\u80fd\\u548cflash\\u5b89\\u5168\\u7b56\\u7565\\u6709\\u5173,\\u8bf7\\u53c2\\u8003<a href=\'http://open.map.qq.com/javascript_v2/guide-pano.html#link-two\' target=\'_blank\' style=\'color:#7CCD7C;text-decoration:none \'>\\u89e3\\u51b3\\u6b65\\u9aa4</a>\\u3002";g.style.width="255px";g.style.height="45px";g.style.position="absolute";g.style.backgroundColor="black";g.style.color="#FFFFFF";g.style.fontSize="13px";g.style.padding="5px";g.style.opacity=.5;g.style.filter="alpha(opacity=50)";g.style.left=d.offsetWidth/2-127.5+"px";g.style.top="10px";d.appendChild(g)}};u._receiveFromSwf=function(e,d){switch(e){case"interface_ready":this._onInterfaceReady();this._addResetFlash();this._addDefalutPlugin();if(this._getKey("_setPanoValue")&&this._getKey("_setPanoValue").svid!=d.svid){var g=this._getKey("_setPanoValue").svid;this.setPano(g)}this._isFristLoadFlash&&(this._isFristLoadFlash=!1,this.view.fireEvent("loaded",null,this.view));break;case"pano_model_error":this.view.fireEvent("error",null,this.view);break;case"pano_changed":if(d.chartId&&0<d.bestChartLevel){var g=[d.minx/J,w(d.miny),d.maxx/J,w(d.maxy)],h=parseFloat(d.lat),l=parseFloat(d.lng),m={};m.lat=w(h);m.lng=l/J;this._setKey("planeInfo",{bounds:g,minZoom:d.minZoom,maxZoom:d.maxZoom,zoomLevel:d.bestChartLevel,regionId:d.chartId,forwardMatrix:d.forwardMatrix,backwardMatrix:d.backwardMatrix,center:m})}else this._setKey("planeInfo",null);g={};g.dir=d.dir||0;g.x=d.lng||0;g.y=d.lat||0;g.svid=d.svid||"-1";g.mode=d.mode||"day";g.photoTime=d.photoTime||"0000.00";g.sno=d.sno||"-1";g.source=d.source||"qq";this.pano_changed(g);break;case"pov_changed":this.pov_changed(d);break;case"zoom_changed":this.zoom_changed(d.zoom);break;case"label_mouse_over":this._labels[d.id]&&this.view.fireEvent("labelEvent",{id:d.id,type:"mouseover",viewBounds:d.bounds});break;case"label_mouse_out":this._labels[d.id]&&this.view.fireEvent("labelEvent",{id:d.id,type:"mouseout",viewBounds:d.bounds});break;case"label_mouse_click":this._labels[d.id]&&this.view.fireEvent("labelEvent",{id:d.id,type:"click",viewBounds:d.bounds});break;case"thumb_loaded":this._isFirstChange&&(this._isFirstChange=!1);this.view.fireEvent("thumb_loaded",d,this.view);break;case"autoPlayStop":this.view.fireEvent("autoPlayStop",d,this.view);break;case"dragStart":this.view.fireEvent("dragstart",d,this.view);break;case"dragEnd":this.view.fireEvent("dragend",d,this.view);break;default:this.view.fireEvent(e,d,this.view)}};u._genId=function(){var d=K++,h="_panoSwfCallback_"+d;this._setKey("swfId","_panoSwf_"+d);this._setKey("swfCallbackId",h)};u._bindSwfCallback=function(){var d=this._getKey("swfCallbackId"),h=this;window[d]=function(d,e){return h._receiveFromSwf(d,e)}};u._initEvents=function(){var d=this._getKey("panoContainer"),h=this;this._getKey("scrollwheel")&&(this._wheelListener=ra.addScrollEvent(d,S?"DOMMouseScroll":"mousewheel",function(g){g=g||window.event;var l;ia?l=[g.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft),g.clientY+(document.documentElement.scrollTop||document.body.scrollTop)]:g.touches?(l=null,0<g.targetTouches.length?l=g.targetTouches[0]:0<g.changedTouches.length&&(l=g.changedTouches[0]),l=[l.pageX,l.pageY]):l=[g.pageX,g.pageY];var m;if(null===d.parentNode||"none"==d.style.display)m=[0,0,0,0];else{var n=null,r=0,u=0;m=d.offsetWidth;var w=d.offsetHeight;if(d.getBoundingClientRect)n=d.getBoundingClientRect(),u=Math.max(document.documentElement.scrollTop,document.body.scrollTop),r=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),r=n.left+r,u=n.top+u;else{if(document.getBoxObjectFor)n=document.getBoxObjectFor(d),r=d.style.borderLeftWidth?parseInt(d.style.borderLeftWidth):0,u=d.style.borderTopWidth?parseInt(d.style.borderTopWidth):0,r=n.x-r,u=n.y-u;else{r=d.offsetLeft;u=d.offsetTop;n=d.offsetParent;if(n!=d)for(;n;)r+=n.offsetLeft,u+=n.offsetTop,n=n.offsetParent;if(Wa||Q&&"absolute"==d.style.position)r-=document.body.offsetLeft,u-=document.body.offsetTop}for(n=d.parentNode?d.parentNode:null;n&&"BODY"!=n.tagName&&"HTML"!=n.tagName;)r-=n.scrollLeft,u-=n.scrollTop,n=n.parentNode?n.parentNode:null}m=[r,u,m,w]}2<=h.status&&(w=0,g.wheelDelta?w=g.wheelDelta/120:g.detail&&(w=-g.detail/3),h._sendToAs("mouseWheel",{delta:w,mouseX:l[0]-m[0],mouseY:l[1]-m[1]}));g.preventDefault?g.preventDefault():g.returnValue=!1}))};Ia.$setExports(d)');
